{#{% extends "sub_base.html" %}#}
{#{% load static %}#}
{#{% load breadcrumb %}#}
{##}
{#{% block breadcrumbs %}#}
{#<div class="breadcrumb-container">#}
{#    <div class="row">#}
{#        <div class="col-12 col-md-6 col-lg-4">#}
{#        <nav data-aos="fade-left" data-aos-delay="100" aria-label="breadcrumb" class="breadcrumb-nav">#}
{#            <ol class="breadcrumb mb-4">#}
{#                {% url 'account:account_profile' as account_url %}#}
{#                {% url 'home' as home_url %}#}
{#                {% breadcrumb "Home" home_url %}#}
{#                {% breadcrumb "Profile" account_url %}#}
{#                {% breadcrumb "Edit Profile" %}#}
{#            </ol>#}
{#        </nav>#}
{#        </div>#}
{#    </div>#}
{#</div>#}
{#{% endblock %}#}
{##}
{#{% block sub_content %}#}
{#    <style type="text/css">#}
{#        .image-container{#}
{#            height: auto;#}
{#            position: relative;#}
{#        }#}
{##}
{#    </style>#}
{##}
{#    <div class="row gutters-sm">#}
{#        <div class="col-md-3 d-none d-md-block" data-aos="fade-left" data-aos-delay="200">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    {% include 'account/profile_tab.html' %}#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#        <div class="col-md-9" data-aos="fade-left" data-aos-delay="300">#}
{#            <div class="card">#}
{#                <div class="card-header border-bottom mb-3 d-flex d-md-none">#}
{#                    {% include 'account/profile_tab_mobile.html' %}#}
{#                </div>#}
{#                <div class="card-body tab-content">#}
{#                    <div class="tab-pane active" id="profile">#}
{#                        <h6>EDIT YOUR PROFILE INFORMATION</h6>#}
{#                        <hr>#}
{#                        <div class="row">#}
{#                            <form method="POST" enctype="multipart/form-data" class="form-signin">#}
{#                                {% csrf_token %}#}
{#                                <div class="row">#}
{#                                    <div class="col-12 col-xl-4">#}
{#                                        <div class="row">#}
{#                                            <div class="col-12 mb-4">#}
{#                                                <div class="card border-light text-center p-0">#}
{##}
{#                                                    <div class="mt-3 pl-4 pr-4" id="id_image_crop_confirm">#}
{#                                                        <span id="id_cancel" class="btn btn-gray-700">Cancel</span>#}
{#                                                        <span id="id_confirm" class="prm-btn btn ml-4">Validate</span>#}
{#                                                    </div>#}
{#                                                    <div class="card-body py-5">#}
{#                                                        <div class="image-container" id="id_image_container">#}
{#                                                            {% if user.avatar_url and 'default_user_icon.png' not in user.avatar_url %}#}
{#                                                                <img src="{{ user.avatar_url }}"#}
{#                                                                     id="id_profile_image_display"#}
{#                                                                     class="border-2 border-purple user-avatar large-avatar rounded-circle mx-auto profile-image"#}
{#                                                                     alt="Neil Portrait">#}
{#                                                            {% else %}#}
{#                                                                <img src="{% static 'dastore/default_user_icon.png' %}"#}
{#                                                                     id="id_profile_image_display"#}
{#                                                                     class="border-2 border-purple user-avatar large-avatar rounded-circle mx-auto profile-image">#}
{#                                                            {% endif %}#}
{#                                                            <div class="middle" id="id_middle_container">#}
{#                                                                <div class="text"#}
{#                                                                     id="id_text">#}
{#                                                                    Edit#}
{#                                                                </div>#}
{#                                                            </div>#}
{#                                                        </div>#}
{#                                                    </div>#}
{#                                                    <input class="d-none" type="file" name="profile_image" id="id_profile_image" onchange="readURL(this)">#}
{#                                                    <div class="text-gray small">JPG or PNG. Max size of 10 MB.</div>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                        </div>#}
{#                                    </div>#}
{#                                    <div class="col-12 col-xl-8">#}
{#                                        <div class="card card-body bg-white border-light shadow-sm mb-4">#}
{#                                            <h2 class="h5 mb-4">Profile information</h2>#}
{#                                            <div class="row">#}
{#                                                <div class="col-md-6 mb-3">#}
{#                                                    <div>#}
{#                                                        <label for="first_name">First Name</label>#}
{#                                                        <input name="first_name" class="form-control" id="first_name" type="text"#}
{#                                                               placeholder="Enter your first name" value="{{ form.initial.first_name }}"#}
{#                                                               required>#}
{#                                                        {% if form.first_name.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                        {{ form.first_name.errors }}#}
{#                                    </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                                <div class="col-md-6 mb-3">#}
{#                                                    <div>#}
{#                                                        <label for="last_name">Last Name</label>#}
{#                                                        <input name="last_name" class="form-control" id="last_name" type="text"#}
{#                                                               placeholder="Also your last name" value="{{ form.initial.last_name }}"#}
{#                                                               required>#}
{#                                                        {% if form.last_name.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                        {{ form.last_name.errors }}#}
{#                                    </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                            <div class="row">#}
{#                                                <div class="col-md-6 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="email">Email</label>#}
{#                                                        <input name="email" class="form-control" id="email" type="email"#}
{#                                                               placeholder="name@company.com" value="{{ form.initial.email }}" readonly>#}
{#                                                        {% if form.email.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.email.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                                <div class="col-md-6 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="username">Username</label>#}
{#                                                        <input name="username" class="form-control" id="username" type="text"#}
{#                                                               placeholder="Username" value="{{ form.initial.username }}">#}
{#                                                        {% if form.username.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.username.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                                <div class="col-md-6 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="phone">Phone</label>#}
{#                                                        <input name="phone" class="form-control" id="phone" type="number"#}
{#                                                               placeholder="+12-345 678 910" value="{{ form.initial.phone }}" required>#}
{#                                                        {% if form.phone.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.phone.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                            <h2 class="h5 my-4">Address</h2>#}
{#                                            <div class="row">#}
{#                                                <div class="col-sm-9 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="address">Address</label>#}
{#                                                        <input name="address" class="form-control" id="address" type="text"#}
{#                                                               placeholder="Enter your home address" value="{{ form.initial.address|default:'' }}" required>#}
{#                                                        {% if form.address.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.address.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                                <div class="col-sm-3 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="number">Number</label>#}
{#                                                        <input name="number" class="form-control" id="number" type="number"#}
{#                                                               placeholder="No." value="{{ form.initial.number|default:'' }}" required>#}
{#                                                        {% if form.number.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.number.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                            <div class="row">#}
{#                                                <div class="col-sm-4 mb-3">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="city">City</label>#}
{#                                                        <input name="city" class="form-control" id="city" type="text" placeholder="City"#}
{#                                                               value="{{ form.initial.city|default:'' }}" required>#}
{#                                                        {% if form.city.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.city.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                                <div class="col-sm-4">#}
{#                                                    <div class="form-group">#}
{#                                                        <label for="zip">ZIP</label>#}
{#                                                        <input name="zip" class="form-control" id="zip" type="tel" placeholder="ZIP"#}
{#                                                               value="{{ form.initial.zip|default:'' }}" required>#}
{#                                                        {% if form.zip.errors %}#}
{#                                                            <span style="color: red;margin: 0">#}
{#                                            {{ form.zip.errors }}#}
{#                                        </span>#}
{#                                                        {% endif %}#}
{#                                                    </div>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                            <div class="mt-3">#}
{#                                                <a class="btn btn-outline-light text-gray-700" href="{% url 'account:account_profile' %}"><i class="fas fa-angle-left mr-2"></i>Return</a>#}
{#                                                <button type="submit" class="prm-btn btn mx-2">Update Detail</button>#}
{#                                            </div>#}
{#                                        </div>#}
{#                                    </div>#}
{#                                </div>#}
{#                            </form>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{#{% endblock %}#}
{#{% block script %}#}
{#    <script type="text/javascript">#}
{#        var cropper, imageFile, base64ImageString, cropX, cropY, cropWidth, cropHeight;#}
{##}
{#        enableImageOverlay()#}
{##}
{#        function readURL(input){#}
{#            if(input.files && input.files[0]){#}
{#                var reader = new FileReader()#}
{##}
{#                reader.onload = function(e){#}
{#                    disableImageOverlay()#}
{#                    var image = e.target.result#}
{#                    var imageField = document.getElementById("id_profile_image_display")#}
{#                    imageField.src = image#}
{#                    cropper = new Cropper(imageField, {#}
{#                        aspectRatio: 1/1,#}
{#                        crop(event){#}
{#                            console.log("CROP START")#}
{#                            console.log("x: " + event.detail.x)#}
{#                            console.log("y: " + event.detail.y)#}
{#                            console.log("width: " + event.detail.width)#}
{#                            console.log("height: " + event.detail.height)#}
{#                            setImageCropProperties(#}
{#                                image,#}
{#                                event.detail.x,#}
{#                                event.detail.y,#}
{#                                event.detail.width,#}
{#                                event.detail.height,#}
{#                            )#}
{#                        }#}
{#                    })#}
{#                }#}
{##}
{#                reader.readAsDataURL(input.files[0])#}
{#            }#}
{#        }#}
{##}
{#        function setImageCropProperties(image, x, y, width, height){#}
{#            imageFile = image#}
{#            cropX = x#}
{#            cropY = y#}
{#            cropWidth = width#}
{#            cropHeight = height#}
{#        }#}
{##}
{#        function isImageSizeValid(image){#}
{#            var startIndex = image.indexOf("base64,") + 7#}
{#            var base64str = image.substr(startIndex)#}
{#            var decoded = atob(base64str)#}
{#            if(decoded.length >= "{{ DATA_UPLOAD_MAX_MEMORY_SIZE }}"){#}
{#                return null#}
{#            }#}
{#            return base64str#}
{#        }#}
{#        function cropImage(image, x, y, width, height){#}
{#            base64ImageString = isImageSizeValid(image)#}
{#            if(base64ImageString != null){#}
{#                var requestData = {#}
{#                    "csrfmiddlewaretoken": "{{ csrf_token }}",#}
{#                    "image": base64ImageString,#}
{#                    "cropX": cropX,#}
{#                    "cropY": cropY,#}
{#                    "cropWidth": cropWidth,#}
{#                    "cropHeight": cropHeight,#}
{#                }#}
{#                displayLoadingSpinner(true)#}
{#                $.ajax({#}
{#                    type: 'POST',#}
{#                    dataType: "json",#}
{#                    url: "{% url 'account:account_crop_image' user_id=form.initial.id %}",#}
{#                    data: requestData,#}
{#                    timeout: 10000,#}
{#                    success: function (data){#}
{#                        if(data.result == "success"){#}
{#                            document.getElementById("id_cancel").click()#}
{#                        }else if(data.result == "error"){#}
{#                            alert(data.exception)#}
{#                            document.getElementById("id_cancel").click()#}
{#                        }#}
{#                    },#}
{#                    error: function (data){#}
{#                        console.log("ERROR...", data)#}
{#                    },#}
{#                    complete: function (data){#}
{#                        displayLoadingSpinner(false)#}
{#                    },#}
{#                })#}
{#            }else{#}
{#                alert("Upload an image smaller than 10MB !")#}
{#                document.getElementById("id_cancel").click()#}
{#            }#}
{#        }#}
{##}
{#        function enableImageOverlay(){#}
{#            var text = document.getElementById("id_text")#}
{#            text.style.backgroundColor = "#0066ff"#}
{#            text.style.color = "white"#}
{#            text.style.fontSize = "16px"#}
{#            text.style.padding = "16px 32px"#}
{#            text.style.cursor = "pointer"#}
{##}
{#            var profileImage = document.getElementById("id_profile_image")#}
{#            profileImage.style.opacity = "1"#}
{#            profileImage.style.display = "block"#}
{#            profileImage.style.width = "100%"#}
{#            profileImage.style.height = "100%"#}
{#            profileImage.style.transition = ".5s ease"#}
{#            profileImage.style.backfaceVisibility = "hidden"#}
{#            profileImage.style.cursor = "pointer"#}
{##}
{#            var middleContainer = document.getElementById("id_middle_container")#}
            {#middleContainer.style.transition = ".5s ease"#}
{#            middleContainer.style.opacity = "0"#}
{#            middleContainer.style.position = "absolute"#}
{#            middleContainer.style.top = "50%"#}
{#            middleContainer.style.left = "50%"#}
{#            middleContainer.style.transform = "translate(-50%, -50%)"#}
{##}
{#            var imageContainer = document.getElementById("id_image_container")#}
{##}
{#            imageContainer.addEventListener("mouseover", function (event){#}
{#                profileImage.style.opacity = "0.3"#}
{#                middleContainer.style.opacity = "1"#}
{#            })#}
{#            imageContainer.addEventListener("mouseout", function (event){#}
{#                profileImage.style.opacity = "1"#}
{#                middleContainer.style.opacity = "0"#}
{#            })#}
{#            imageContainer.addEventListener("click", function (event){#}
{#                document.getElementById("id_profile_image").click()#}
{#            })#}
{##}
{#            var cropConfirm = document.getElementById("id_image_crop_confirm")#}
{#            cropConfirm.classList.remove("d-flex")#}
{#            cropConfirm.classList.remove("flex-row")#}
{#            cropConfirm.classList.remove("justify-content-between")#}
{#            cropConfirm.classList.add("d-none")#}
{#        }#}
{##}
{#        function disableImageOverlay(){#}
{#            var profileImage = document.getElementById("id_profile_image_display")#}
{#            var middleContainer = document.getElementById("id_middle_container")#}
{#            var imageContainer = document.getElementById("id_image_container")#}
{#            var text = document.getElementById("id_text")#}
{##}
{#            imageContainer.removeEventListener("mouseover", function(event){#}
{##}
{#            })#}
{#            imageContainer.removeEventListener("mouseout", function(event){#}
{##}
{#            })#}
{##}
{#            profileImage.style.opacity = "1"#}
{#            middleContainer.style.opacity = "1"#}
{#            text.style.cursor = "default"#}
{#            text.style.opacity = "0"#}
{##}
{#            imageContainer.removeEventListener("click", function(event){#}
                {#event.preventDefault()#}
{#            })#}
{##}
{#            document.getElementById("id_profile_image").addEventListener("click", function(event){#}
{#                event.preventDefault()#}
{#            })#}
{##}
{#            var cropConfirm = document.getElementById("id_image_crop_confirm")#}
{#            cropConfirm.classList.add("d-flex")#}
{#            cropConfirm.classList.add("flex-row")#}
{#            cropConfirm.classList.add("justify-content-between")#}
{#            cropConfirm.classList.remove("d-none")#}
{##}
{#            var confirm = document.getElementById("id_confirm")#}
{#            confirm.addEventListener("click", function (event){#}
{#                cropImage(imageFile, cropX, cropY, cropWidth, cropHeight)#}
{##}
{#            })#}
{##}
{#            var cancel = document.getElementById("id_cancel")#}
{#            cancel.addEventListener("click", function(event){#}
{#                console.log("Reloading window...")#}
{#                window.location.reload()#}
{#            })#}
{#        }#}
{#    </script>#}
{#{% endblock %}#}